function generateDocx(mk, semester, dosen) {
  const {
    Document, Packer, Paragraph, TextRun,
    HeadingLevel, Table, TableRow, TableCell, WidthType
  } = window.docx;

  let content = [];

  content.push(new Paragraph({
    text: "RPS & RPP",
    heading: HeadingLevel.HEADING_1,
    alignment: "center"
  }));

  content.push(new Paragraph(`Mata Kuliah: ${mk}`));
  content.push(new Paragraph(`Semester: ${semester.replace("semester", "")}`));
  content.push(new Paragraph(`Dosen: ${dosen || "-"}`));

  content.push(new Paragraph(""));

  for (let i = 1; i <= 16; i++) {
    const level = soloLevel(i);

    content.push(new Paragraph({
      text: `Pertemuan ${i}`,
      heading: HeadingLevel.HEADING_2
    }));

    if (typeof level !== "number") {
      content.push(new Paragraph(`Evaluasi: ${level}`));
      continue;
    }

    const tujuan = {
      indo: `Mahasiswa mencapai level SOLO ${level} pada ${mk}.`,
      arab: `Ø£Ù† ÙŠØ­Ù‚Ù‚ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø³ØªÙˆÙ‰ SOLO ${level} ÙÙŠ Ù…Ù‚Ø±Ø± ${mk}.`
    };

    content.push(new Paragraph(`Level SOLO: ${level}`));
    content.push(new Paragraph(`ðŸ‡®ðŸ‡© ${tujuan.indo}`));
    content.push(new Paragraph(`ðŸ‡¸ðŸ‡¦ ${tujuan.arab}`));
    content.push(new Paragraph(`Asesmen: ${rubrikSOLO(level)}`));
  }

  const doc = new Document({
    sections: [{ children: content }]
  });

  Packer.toBlob(doc).then(blob => {
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `RPS_RPP_${mk.replace(/\s+/g, "_")}.docx`;
    a.click();
  });
}

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Generator RPS & RPP Ma'had Aly / S1</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/docx@8.2.2/build/index.js"></script>
</head>
<body>

<h1>ðŸ“˜ Generator RPS & RPP (Bilingual Arabâ€“Indonesia)</h1>

<label>Semester:</label>
<select id="semester">
  <option value="semester1">Semester 1</option>
  <option value="semester2">Semester 2</option>
  <option value="semester3">Semester 3</option>
  <option value="semester4">Semester 4</option>
  <option value="semester5">Semester 5</option>
  <option value="semester6">Semester 6</option>
</select>

<label>Mata Kuliah:</label>
<select id="mataKuliah"></select>

<label>Nama Dosen:</label>
<input type="text" id="dosen" placeholder="Nama Dosen">

<button onclick="generate()">ðŸ“„ Generate RPS + RPP (Word)</button>

<script src="data.js"></script>
<script src="solo.js"></script>
<script src="rubrik.js"></script>
<script src="generator.js"></script>
<script src="docx-generator.js"></script>

</body>
</html>

body {
  font-family: Arial, sans-serif;
  margin: 40px;
}

h1 {
  margin-bottom: 20px;
}

label {
  display: block;
  margin-top: 15px;
  font-weight: bold;
}

select, input, button {
  width: 320px;
  padding: 8px;
  margin-top: 5px;
}

button {
  margin-top: 25px;
  font-weight: bold;
  cursor: pointer;
}

const mataKuliah = {
  semester1: [
    "Tahdzibul Akhlak",
    "Bahasa Arab 1",
    "Ilmu Shorof",
    "Imla'",
    "Ilmu Nahwu 1",
    "Dirosah Maktabiyah 1",
    "Ta'bir Syafahi",
    "Ta'bir Tahriri",
    "Riyadhoh"
  ],
  semester2: [
    "Fiqih Lughoh",
    "Bahasa Arab 2",
    "Ilmu Shorof",
    "Fiqih Syafi'i",
    "Ilmu Balaghoh",
    "Ilmu Nahwu 2",
    "Ilmu Komputer",
    "Dirosah Maktabiyah 2",
    "Maharoh Lughoh Kalam 1",
    "Aqidah Al Islamiyah 1"
  ],
  semester3: [
    "Bahasa Indonesia",
    "Fathul Kutub 1",
    "Ilmu Ushul Fiqih",
    "Tafsir Tadabbur 1",
    "Aqidah Al Islamiyah 2",
    "Fiqih Muamalah",
    "Ulumul Quran",
    "Ilmu Nahwu 3",
    "Maharoh Lughoh Al-Kalam 2",
    "Qowaidul Fiqhiyah",
    "Bahasa Arab 3"
  ],
  semester4: [
    "Mushtolah Hadits",
    "Fathul Kutub 2",
    "Al Adab wa An-Nushus",
    "Tafsir Tadabbur 2",
    "Tahtit Al-Barnamij Al-Lughowi",
    "Dirosah Maktabiyah 3",
    "Ilmu Arudl",
    "Ilmu Nahwu 4",
    "Al-Qiroah Ar-Rosyidah",
    "Bahasa Arab 4",
    "Manahijul Bahts"
  ],
  semester5: [
    "Isti'mal Al-Lughowi",
    "Tafsir Tadabbur 3",
    "Manahij At-Tarbawi",
    "Tatbiqot At-Tarjamah",
    "Al-Qiroah Ar-Rosyidah 1",
    "Dirosah Maktabiyah 4",
    "Tahsin",
    "Ilmu Nahwu 5",
    "Tadribat Al-Lughowi"
  ],
  semester6: [
    "Ta'limul Lughoh Arabiyah",
    "Tsaqofah Islamiyah",
    "Kitabah Mubarroroh",
    "Dirosah Maktabiyah 5",
    "Tarikh Hadloroh",
    "Ilmu Nahwu 6",
    "Al-Qiroah Ar-Rosyidah 2",
    "Metode Penelitian",
    "Hadits Tarbawi"
  ]
};

function soloLevel(pertemuan) {
  if (pertemuan === 1) return 1;
  if (pertemuan <= 3) return 2;
  if (pertemuan <= 5) return 3;
  if (pertemuan === 6) return 4;
  if (pertemuan === 7) return "UTS";
  if (pertemuan <= 9) return 3;
  if (pertemuan <= 11) return 4;
  if (pertemuan <= 14) return 5;
  if (pertemuan === 15) return "UAS";
  return "Refleksi";
}

function rubrikSOLO(level) {
  if (level === 1) return "Tes pengenalan konsep dasar";
  if (level === 2) return "Tes pemahaman satu konsep";
  if (level === 3) return "Penugasan analisis beberapa konsep";
  if (level === 4) return "Studi kasus dan presentasi";
  if (level === 5) return "Proyek atau makalah analitis";
  return "Evaluasi sumatif";
}

const semesterSelect = document.getElementById("semester");
const mkSelect = document.getElementById("mataKuliah");

function loadMK() {
  mkSelect.innerHTML = "";
  mataKuliah[semesterSelect.value].forEach(mk => {
    const opt = document.createElement("option");
    opt.value = mk;
    opt.text = mk;
    mkSelect.add(opt);
  });
}

semesterSelect.onchange = loadMK;
window.onload = loadMK;

function generate() {
  generateDocx(
    mkSelect.value,
    semesterSelect.value,
    document.getElementById("dosen").value
  );
}
